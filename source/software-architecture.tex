\section{A szoftver architektúrája}

\subsection{Futási környezet}

A program webes technológiákon alapul, így működtethető böngészőből, illetve
böngészőtől független önálló becsomagolt állományból is.

\subsection{Felhasznált könyvtárak}

\begin{itemize}
  \item Electron: Az önlállóan futtatható állomány létrehozásához. \\
  https://electronjs.org/

  \item Redux: Az alkalmazás központi állapotának tárolásához és kezeléséhez. \\
  https://redux.js.org/

  \item Golden Layout: A dinamius, felhasználó által személyre szabható felület
  kialakítására. \\
  https://golden-layout.com/

  \item Material UI: A felhasználói felületen megjelenő elemek kinézetéhez. \\
  http://www.material-ui.com/ |  https://material-ui-next.com/

  \item OpenLayers: A térképes megjelenítéshez. \\
  https://openlayers.org/

  \item React: Minden másra? :D \\
  https://reactjs.org/

  \item ol-react: Az OpenLayers könyvtár által nyújtott funkciók React
  komponensekként való kezeléséhez. \\
  https://www.npmjs.com/package/ol-react

  \item mini-signals: Az alkalmazás komponensei közötti üzenetküldésre. \\
  https://github.com/Hypercubed/mini-signals
\end{itemize}

\subsection{A megvalósított osztályok}

\subsubsection{HeatmapLayerSettingsPresentation}
A hőtérkép réteg beállításait tartalmazó komponens.
Itt adhatóak meg az aktuális réteg úgymond "feliratkozásai", tehát, hogy melyik
eszköz melyik csatornáján érkező adatok megjelenítését végezze.
Beállítható továbbá a jelölők közötti távolság, hogy rácspontokon kerüljenek-e
elhelyezésre, vagy pedig minél közelebb a mérés helyéhez, valamint a skála
végpontjai, hogy automatikusan skálázódjon-e újabb extremális érétkek
érkezésekor, illetve hogy lineáris vagy pedig logaritmikus legyen.

\subsubsection{HeatmapVectorSource}
Az \verb|ol-react| csomag által biztosított \verb|source.Vector| osztályból
származtatott osztály, amely a hőtérképen megjelenő színes jelölők
létrehozásáért és frissítéséért felelős.
A drónokról érkező üzenetek feldolgozása és az adatok \verb|localStorage|-be
történő szinkonizálása is ebben az objektumban történik, így újratöltéskor nem
vesznek el az eddigi mérés eredményei.

\subsubsection{HeatmapLayerPresentation}
A hőtérképet megjelenítő réteg. Kirajzolja a vektor forrásból származó jelölőket
és a térkép sarkába pedig egy skálát az értékekhez.

\subsubsection{MapReferenceRequestHandler}
A központi OpenLayers térkép példány objektumhoz történő közvetlen hozzáférésre
a programban több helyen is szükség van. Ez a komponens szolgál az ilyen jellegű
igények kielégítésére oly módon, hogy feliratkozik a központi
\verb|mapReferenceRequestSignal| jelzésre, és minden ezen keresztüli üzenetben
érkező callback függvényt meghív a térkép objektum referenciájával
paraméterként, amihez oly módon fér hozzá, hogy a térkép React komponensének
leszármazottjaként a kontextus objektumából el tudja érni.

\subsubsection{MapViewManager}
A központi OpenLayers térkép példány nézeti objektumának kezelésére szolgáló
osztály. Folyamatosan tárolja az aktuális pozítiót, elfordulást és nagyítást,
valamint feliratkozik az ezekhez tartozó eseményekhez, hogy mindig frissíteni
tudja az értékeket, ha szükséges, így ezek az adatok bármikor lekérdezhetőek
belőle. Ezen felül képes a térkép nézeti paraméterének módosításaira is például
egy elmentett állapot visszatöltéséhez, vagy mondjuk adott drónhoz ugráshoz.

\subsubsection{SavedLocationEditorDialog}
Az elmentett térképállapotok szerkesztésére szolgáló dialógusablak, amelyben
szerkeszthető egy adott bejegyzés neve, középpontjának szélességi és hosszúsági
foka, elforgatási szöge és nagyítási mértéke.

\subsubsection{SavedLocationList}
Az elmentett térképállapotok felsorolására szolgáló lista, melynek első eleme
állandóan a jelenlegi állapotot tartalmazza, és arra történő kattintással az
aktuális adatok felvehetőek a listába.

\subsubsection{GeoJSONLayerSettingsPresentation}
A GeoJSON formátumban tárolt geometriák megjelenítésére szolgáló réteg
beállításait tartalmazó osztály. Megadható a rétegre betöltött objektumok
kitöltésének és körvonalának színe, valamint itt található egy szövegdoboz is,
amibe a kívánt GeoJSON adatokat kell beilleszteni, majd pedig az alatta lévő
gomb segítségével validálni és importálni a térképre.

\subsubsection{GeoJSONVectorSource}
Az \verb|ol-react| csomag által biztosított \verb|source.Vector| osztályból
származtatott osztály, amely a GeoJSON rétegen megjelenő geometriák stílusának
beállításáért és az OpenLayers beépített GeoJSON olvasójának segítségével
történő előállításáért felelős a \verb|GeoJSONLayerPresentation| osztály
számára.

\subsubsection{GeoJSONLayerPresentation}
Megjeleníti a \verb|GeoJSONVectorSource| által előállított geometriákat a
térképen.

\subsubsection{MapToolbar}
A térképpel kapcsolatos eszközöket tartalmazó eszköztár. Különböző módok
választhatóak rajta, amik az egérrel végrehajtható akciókat befolyásolják. Az
elérhető módok: kijelölés, mozgatás, nagyítás. Található még rajta továbbá egy
szövegdoboz, ami a térkép elfordulását mutatja fokokban, és a felhasználó által
is átírható egy kivánt szög beállításának céljából. Ezeken felül még két gombot
tartalmaz, egyet az északi orientáció visszaállítására, egyet pedig a térkép oly
módon történő pozícionálására, hogy az összes jelenleg látható objektum
beleférjen a képbe.

\subsubsection{ContextMenu}
A térkép egy üres részén vagy egy drón fölött kezdeményezett jobb egérgomb
esemény következtében megjelenő helyi menüt megvalósító osztály. A drónoknak
kiadható utasításokat tartalmazza. (Felszállás, leszállás, visszatérés a
kiindulópontra, kikapcsolás.)

\subsubsection{FilterableSortableTable}
Adatok táblázatban szűrhető és sorbarendezhető táblázatban történő
megjelenítésére szolgáló osztály. Szűrés szempontjából három különböző fajta
értéktípust támogat. Felsorolható adattípus esetén az egyes típusok ki és
bekapcsolását, tartomány esetén intervallumra való leszűkítést, szöveges adat
esetén pedig keresést a szöveg tetszőleges pontján. Sorbarendezéshez minden
oszlophoz külön külön saját összehasonlító függvény adható meg.

\subsubsection{LogPanel}

A naplóbejegyzéseket tartalmazó panel \verb|FilterableSortableTable|
segítségével implementálva. Három oszlopa van. A bejegyzés súlyossága
(felsorolható típusú: információ, figyelmeztetés vagy hiba), bejegyzés időpontja
(tartomány típusú), valamint a bejegyzés szövege (szöveg típusú).

\subsubsection{GroundControlPanel}

Egy táblázatot tartalmazó panel, melyben a drónok részletes adatai találhatóak,
mint például koordináták, magasság, akkufeszültség, aktuálisan futó algoritmus.
A sorok közül nyíl billenyűkkel vagy kattintással kiválasztva egyet az enter
billentyű lenyomását követően üzenet küldhető az adott drónnak.

\subsubsection{OwnLocationLayerSettingsPresentation}

A felhasználó geolokációját megjelenítő réteg beállításait tartalmazó komponens.

\subsubsection{OwnLocationVectorSource}

A felhasználó geolokációt jelölő ikon előállításáért és újabb pozícióra vagy
elfordulásra vonatkozó adatok érkezésekor történő frissítéséért felelős osztály.

\subsubsection{OwnLocationLayerPresentation}

A felhasználó geolokációjának térképen való megjelenítéséért felelős osztály.

\subsubsection{HotkeyHandler}

A billentyűparancsok érzékeléséért és a hozzájuk rendelt feladatok
végrehajtásáért felelős osztály. Ez egy konténerként szolgáló komponens
segítéségével kerül megvalósítására, mely figyeli a rajta keresztül érkező
billenytűlenyomás eseményeket.

\begin{figure}[H]
  \centering
    \includegraphics[width=\textwidth]{class_diagram.pdf}
  \caption{Osztálydiagram}
\end{figure}
